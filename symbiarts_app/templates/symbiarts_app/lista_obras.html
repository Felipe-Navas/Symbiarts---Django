{% extends 'symbiarts_app/base.html' %}
{% load static %}
{% block title %}Tienda Symbiarts{% endblock %}

{% block navbar %}
    {% include 'symbiarts_app/navbar.html' %}
{% endblock %}

{% block content %}
    {% if cadena_buscada %}
        <div class="row mt-3">
            <h4>Resultados para: "{{ cadena_buscada }}"</h4>
        </div>
    {% endif %}
        <div class="card-columns">
            {% for obra in obras %}
                <div class="card_lista_obras card mt-3 mx-1">
                    <a href="{% url 'symbiarts_app:detalle_obra' pk=obra.pk %}">
                        {% with archivo_obra=obra.archivos.first %}
                            {% if archivo_obra.archivo.url %}
                                <img class="card-img-top img-fluid" src="{{ archivo_obra.archivo.url }}" alt="{{ obra.nombre }}">
                            {% else %}
                                <img class="card-img-top img-fluid" src="{% static 'img/default.svg' %}" alt="{{ obra.nombre }}">
                            {% endif %}
                        {% endwith %}
                        <div class="card-body">
                            <h5>{{ obra.nombre }}
                                {% if obra.precio %}
                                    <span class="precio_lista_obras">${{ obra.precio }}</span>
                                {% endif %}
                            </h5>
                        </div>
                        <div class="card-footer text-muted">
                            Publicada el {{ obra.fecha_publicacion }}
                            <br>
                            {% if obra.comentarios.count == 0 %}
                                No tiene comentarios
                            {% elif obra.comentarios.count == 1 %}
                                Tiene 1 comentario
                            {% else %}
                                Tiene {{ obra.comentarios.count }} comentarios
                            {% endif %}
                        </div>
                    </a>
                </div>
            {% endfor %}
        </div>

    {% include 'symbiarts_app/paginator.html' with paginator=obras %}

{% endblock %}
